<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;ruby&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="ruby">ruby</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://www.white.technology'>Sign Up for a developer key</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <!---
  - contacts
  - items
  - invoices
  - vats
  - currencies
  - countries
  - languages
  - white_scans
  - errors
--->

<h1 id="introduction">Introduction</h1>

<p>Welcome to the <strong>White</strong> API documentation! You will find here everything there is to know about our API. Don&rsquo;t hesitate to <a href="mailto:support@white.eu.com">get in touch</a> if that is not enough.</p>

<p>Have fun.</p>

<h1 id="authorization">Authorization</h1>

<blockquote>
<p>Example of authorization process</p>
</blockquote>
<pre class="highlight shell"><code><span class="c">#!/usr/bin/env bash</span>

<span class="c"># Get the authorization code</span>

curl -X POST <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">client_id</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">CLIENT_ID</span><span class="se">\"</span><span class="s2">, </span><span class="se">\</span><span class="s2">
       </span><span class="se">\"</span><span class="s2">client_secret</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">CLIENT_SECRET</span><span class="se">\"</span><span class="s2">, </span><span class="se">\</span><span class="s2">
       </span><span class="se">\"</span><span class="s2">redirect_uri</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">REDIRECT_URI</span><span class="se">\"</span><span class="s2">, </span><span class="se">\</span><span class="s2">
       </span><span class="se">\"</span><span class="s2">response_type</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">code</span><span class="se">\"</span><span class="s2">}"</span> <span class="se">\</span>
  http://kpmg.white.technology/api/oauth/authorize.json

<span class="c"># Get the access token</span>

curl -X POST <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s2">"{</span><span class="se">\"</span><span class="s2">client_id</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">CLIENT_ID</span><span class="se">\"</span><span class="s2">, </span><span class="se">\</span><span class="s2">
       </span><span class="se">\"</span><span class="s2">client_secret</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">CLIENT_SECRET</span><span class="se">\"</span><span class="s2">, </span><span class="se">\</span><span class="s2">
       </span><span class="se">\"</span><span class="s2">redirect_uri</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">REDIRECT_URI</span><span class="se">\"</span><span class="s2">, </span><span class="se">\</span><span class="s2">
       </span><span class="se">\"</span><span class="s2">code</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">CODE</span><span class="se">\"</span><span class="s2">, </span><span class="se">\</span><span class="s2">
       </span><span class="se">\"</span><span class="s2">grant_type</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">authorization_code</span><span class="se">\"</span><span class="s2">}"</span> <span class="se">\</span>
  http://kpmg.white.technology/api/oauth/token.json
</code></pre>
<pre class="highlight ruby"><code><span class="n">gem</span> <span class="n">install</span> <span class="s1">'faraday'</span> <span class="c1"># Without bundler</span>
<span class="n">gem</span> <span class="s1">'faraday'</span> <span class="c1"># With bundler (Gemfile)</span>

<span class="nb">require</span> <span class="s1">'faraday'</span>

<span class="n">faraday</span> <span class="o">=</span> <span class="no">Faraday</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">:url</span> <span class="o">=&gt;</span> <span class="s1">'http://kpmg.white.technology'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">faraday</span><span class="o">|</span>
            <span class="n">faraday</span><span class="p">.</span><span class="nf">request</span> <span class="ss">:url_encoded</span>
            <span class="n">faraday</span><span class="p">.</span><span class="nf">adapter</span> <span class="no">Faraday</span><span class="p">.</span><span class="nf">default_adapter</span>
          <span class="k">end</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">faraday</span><span class="p">.</span><span class="nf">post</span> <span class="s1">'api/oauth/authorize.json'</span><span class="p">,</span>
                      <span class="p">{</span>
                          <span class="ss">:client_id</span> <span class="o">=&gt;</span> <span class="no">CLIENT_ID</span><span class="p">,</span>          <span class="c1"># Ask us for yours</span>
                          <span class="ss">:client_secret</span> <span class="o">=&gt;</span> <span class="no">CLIENT_SECRET</span><span class="p">,</span>  <span class="c1"># Ask us for yours</span>
                          <span class="ss">:redirect_uri</span> <span class="o">=&gt;</span> <span class="no">REDIRECT_URI</span><span class="p">,</span>    <span class="c1"># Must be https/ssl!</span>
                          <span class="ss">:response_type</span> <span class="o">=&gt;</span> <span class="s1">'code'</span>
                      <span class="p">}</span>

<span class="n">code</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">)[</span><span class="s1">'code'</span><span class="p">]</span>

<span class="n">response</span> <span class="o">=</span> <span class="vi">@conn</span><span class="p">.</span><span class="nf">post</span> <span class="s1">'api/oauth/token.json'</span><span class="p">,</span>
                      <span class="p">{</span>
                          <span class="ss">:client_id</span> <span class="o">=&gt;</span> <span class="no">CLIENT_ID</span><span class="p">,</span>          <span class="c1"># Same as above</span>
                          <span class="ss">:client_secret</span> <span class="o">=&gt;</span> <span class="no">CLIENT_SECRET</span><span class="p">,</span>  <span class="c1"># Same as above</span>
                          <span class="ss">:redirect_uri</span>  <span class="o">=&gt;</span> <span class="no">REDIRECT_URI</span><span class="p">,</span>   <span class="c1"># Same as above</span>
                          <span class="ss">:code</span> <span class="o">=&gt;</span> <span class="n">code</span><span class="p">,</span>                    <span class="c1"># Result of previous request</span>
                          <span class="ss">:grant_type</span> <span class="o">=&gt;</span> <span class="s1">'authorization_code'</span>
                      <span class="p">}</span>

<span class="n">token</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="vi">@response</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>

</code></pre>

<p><strong>White</strong> uses an <a href="http://oauth.net/2/">OAuth2</a> authorization / authentication protocol to grant access to the API.</p>

<p>The authentication takes an <code class="prettyprint">access token</code> that must be provided in the header of every request.</p>

<p><code class="prettyprint">
 &quot;Authorization: Bearer ACCESS_TOKEN&quot;
</code></p>

<p>example:</p>

<p><code class="prettyprint">
 &quot;Authorization: Bearer 14q1506268bed878972b42e9f99154f37ef9a214042542782c54e946ce845a64&quot;
</code></p>

<p>To obtain your <code class="prettyprint">access token</code>, you need to</p>

<ol>
<li>Request a new <code class="prettyprint">client_id</code> / <code class="prettyprint">client_secret</code> pair in <a href="https://app.white.technology/application/settings/api">your application settings</a>.</li>
<li>Use this code pair to get an authorization code.</li>
<li>Use the authorization code to get an <code class="prettyprint">access token</code>.</li>
</ol>

<aside class="notice">
<ol>
 <li>Access tokens are bound to users. If you wish to give different acces to <bold>White</bold> for different users you are welcome to do so by giving each user a different key.</li>
 <li>Even though our <code>access tokens</code> do not expire, you can revoke them or request a new one at any moment.</li>
<ol>
</aside>

<p>Numerous libraries exist in every language to acquire OAuth2 access tokens. You are free to use any of them.</p>

          <h1 id="organizations">Organizations</h1>

<p>An organization is a company or any other legal entity (association, etc.). For most requests you&rsquo;ll have to specify in the url path what company the request is
referring to. For instance creating an invoice is linked to an organization. Adding a document is linked to an organization, etc.</p>

<p>Each organization is referred to by a unique name, called in the web application interface <code class="prettyprint">white name</code>.
You are free to choose whatever name you wish for an organization as long as it is unique across all organizations.</p>

<p>So for instance, all requests for the <code class="prettyprint">microsoft</code> organization would have the <code class="prettyprint">:organization</code> placeholder replaced by <code class="prettyprint">microsoft</code>.</p>

<p><code class="prettyprint">http://kpmg.white.technology/api/v1/:organization</code></p>

          <h1 id="jobs">Jobs</h1>

<p>We call a <code class="prettyprint">job</code> the task of processing a document to read, qualify and book it. You can create <code class="prettyprint">jobs</code> through our API and
retrieve their results.</p>

<p>A job cannot be destroyed.</p>

<h2 id="creating-a-job">Creating a job</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'faraday'</span>

<span class="vi">@conn</span> <span class="o">=</span> <span class="no">Faraday</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">:url</span> <span class="o">=&gt;</span> <span class="s1">'http://kpmg.white.technology'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">faraday</span><span class="o">|</span>
  <span class="n">faraday</span><span class="p">.</span><span class="nf">request</span> <span class="ss">:multipart</span> <span class="c1"># To send files</span>
  <span class="n">faraday</span><span class="p">.</span><span class="nf">adapter</span> <span class="ss">:net_http</span>  <span class="c1"># To send files</span>
<span class="k">end</span>

<span class="vi">@payload</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">:file</span> <span class="o">=&gt;</span> <span class="no">Faraday</span><span class="o">::</span><span class="no">UploadIO</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'file.pdf'</span><span class="p">,</span> <span class="s1">'application/pdf'</span><span class="p">),</span>
             <span class="ss">:provider</span> <span class="o">=&gt;</span> <span class="kp">true</span>  <span class="c1"># The file is coming from one of our providers</span>
           <span class="p">}</span>

<span class="vi">@query</span> <span class="o">=</span> <span class="vi">@conn</span><span class="p">.</span><span class="nf">post</span> <span class="s1">'api/v1/:organization/jobs.json'</span><span class="p">,</span>
                    <span class="vi">@payload</span><span class="p">,</span>
                    <span class="p">{</span> <span class="s1">'Authorization'</span> <span class="o">=&gt;</span> <span class="s2">"Bearer ACCESS_TOKEN"</span> <span class="p">}</span>

</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55bb001fb9b8464ca2d23ac8449f269c"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST http://kpmg.white.technology/api/v1/:organization/jobs</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>file</td>
<td>File</td>
<td></td>
<td>true</td>
<td>The file to process</td>
</tr>
<tr>
<td>provider</td>
<td>Boolean</td>
<td></td>
<td>true</td>
<td>Set to <code class="prettyprint">true</code> if the document is from a provider. Set to <code class="prettyprint">false</code> if the document is for a client.</td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td></td>
<td>false</td>
<td>A possible ID to refer to the job later on. If none is passed, an ID is generated. The ID, whether passed or not is returned in the reply.</td>
</tr>
</tbody></table>

<aside class="notice">
If you provide an <code>id</code>, it must be unique to the organization or the request will be rejected.
</aside>

<h2 id="retrieving-a-job">Retrieving a job</h2>

<p>You can retrieve the result of a job with its <code class="prettyprint">id</code>.</p>

<p>The returned object has a <code class="prettyprint">processed</code> boolean field stating if the job has been processed or is still queued.</p>

<table><thead>
<tr>
<th>Processed</th>
<th>Status</th>
<th>Returned object</th>
</tr>
</thead><tbody>
<tr>
<td>false</td>
<td>Queued</td>
<td>All values of the returned object are null.</td>
</tr>
<tr>
<td>true</td>
<td>Processed</td>
<td>The values of the object are filled.</td>
</tr>
</tbody></table>
<pre class="highlight shell"><code>  curl -H <span class="s2">"Authorization: Bearer ACCESS_TOKEN"</span> <span class="se">\</span>
       -X GET <span class="se">\</span>
       http://kpmg.white.technology/api/v1/:organization/jobs/:id.json
</code></pre>
<pre class="highlight ruby"><code>
  <span class="vi">@faraday</span> <span class="o">=</span> <span class="no">Faraday</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">:url</span> <span class="o">=&gt;</span> <span class="s1">'http://kpmg.white.technology'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">faraday</span><span class="o">|</span>
    <span class="n">faraday</span><span class="p">.</span><span class="nf">request</span> <span class="ss">:url_encoded</span>
    <span class="n">faraday</span><span class="p">.</span><span class="nf">adapter</span> <span class="no">Faraday</span><span class="p">.</span><span class="nf">default_adapter</span>
  <span class="k">end</span>

  <span class="vi">@response</span> <span class="o">=</span> <span class="vi">@faraday</span><span class="p">.</span><span class="nf">get</span> <span class="s1">'api/v1/:organization/jobs/:id.json'</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"job"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34d5b9b3c2fe4752b35fcbb5ebb7f6f3"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tag"</span><span class="p">:</span><span class="w"> </span><span class="s2">"etude_et_prestation_de_service"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"document_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invoice"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"value_date"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EUR"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Lennon"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"78 boulevard Voltaire"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"zip_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"75011"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Paris"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john.lennon@gmail.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0101010101"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"vat_number"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"national_number"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"prices"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"inclusive_tax"</span><span class="p">:</span><span class="w"> </span><span class="mf">250.0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"exclusive_tax"</span><span class="p">:</span><span class="w"> </span><span class="mf">238.41</span><span class="w">
      </span><span class="p">}],</span><span class="w">
    </span><span class="nt">"processed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://kpmg.white.technology/api/v1/:organization/jobs/:id</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td></td>
<td>true</td>
<td>The id of the job (as returned by the server at job creation)</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="ruby">ruby</a>
          </div>
      </div>
    </div>
  </body>
</html>
